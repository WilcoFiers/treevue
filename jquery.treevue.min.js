/*! jQuery Treevue 2013-06-11 */
!function(a){"use strict";function b(){var b,c=a(this),d=a(this).attr("value");return d||(b=a("label[for="+c.context.id+"]"),0===b.length&&(b=c.closest("label")),b&&(d=a.trim(b.text()))),d}function c(a){var b;a.find("li").attr(k,"treeitem"),a.find("ul, ol").attr({role:"group"}).before(f).closest("li").attr(g,!0).addClass(m),a.attr(k,"tree"),b=a.find("ul[aria-hidden=true], ol[aria-hidden=true]").closest("li"),b=b.find("."+m).andSelf(),b.attr(g,"false"),b.removeClass(m).addClass(n),b.find("ul, ol").attr(i,!0).hide(),a.find(":disabled").closest("li").addClass(p).attr(j,!0)}function d(b){b.find(":checkbox").each(function(){var b=a(this).attr("tabindex",-1);b.prop("checked")?(b.addClass(o),b.closest("li").attr(h,!0)):(b.removeClass(o),b.closest("li").attr(h,!1))}).closest(".treevue").attr("aria-multiselectable",!0)}var e,f,g="aria-expanded",h="aria-selected",i="aria-hidden",j="aria-disabled",k="role",l="treevue-focus",m="treevue-expanded",n="treevue-collapsed",o="treevue-selected",p="treevue-disabled",q="Collapse node",r="Expand node",s="Tree view",t={position:"absolute",width:"0",overflow:"hidden"},u={};u[k]="document",u[i]=!0,e=a('<span class="treevue_fallback">'+s+", </span>"),f=a('<span class="treevue_fallback_branch"><button tabindex="-1">'+q+"</button></span>"),e.css(t).attr(u),f.css(t).attr(u),a.fn.treevue=function(){var a=this.find("> :first-child");return this.addClass("treevue").find("li").attr("tabindex",-1),c(this),d(this),a.attr("tabindex",0).addClass(l),a.prepend(e),this},a(function(){function c(b){var c={target:b.context},d=a();b.each(function(){d=d.add(a("ul, ol",this).first())}),b.hasClass(m)?(b.attr(g,!1),b.addClass(n).removeClass(m),d.hide(200).attr(i,!0),b.find(".treevue_fallback_branch button").first().text(r).trigger(a.Event("collapse",c))):(b.attr(g,!0),b.addClass(m).removeClass(n),d.show(200).attr(i,!1),b.find(".treevue_fallback_branch button").first().text(q).trigger(a.Event("expand",c)))}function d(a){var b=a.closest(".treevue");1===b.length&&(b.find("."+l).removeClass(l).attr("tabindex",-1),a.focus().attr("tabindex",0),a.addClass(l),b.find(".treevue_fallback").detach().prependTo(a))}function e(c){var d=c.closest("[aria-selected]"),e=c.prop("checked"),f=c.closest(".treevue"),g=c.closest("li");d.attr(h,e),"subselector"===c.attr("data-type")&&g.find("ul :checkbox, ol :checkbox").not(":disabled").prop("checked",e),g.parentsUntil(f,"li").each(function(){var b,c=a(this),d=a(":checkbox",this).first();d.closest("li").is(c)&&"subselector"===d.attr("data-type")&&(b=c.find("ul :checkbox, ol :checkbox").not(":disabled"),b.length===b.filter(":checked").length?d.prop("checked",!0):e===!1&&d.prop("checked",!1))}),f.trigger(a.Event("change-selection",{target:f.context,values:f.find(":checked").map(b).get()}))}a("body").on("click",".treevue li."+m+", .treevue li."+n,function(b){if(b.target===this){var e=a(this);b.preventDefault(),c(e),d(e)}}).on("change",".treevue :checkbox",function(){var b=a(this);e(b),d(b.closest("li"))}).on("keydown",".treevue li",function(b){var f,g,i=b.keyCode,j=a(this);if(b.target===this){if(f=j.hasClass(m),13===i&&void 0!==j.attr(h))g=j.find(":checkbox").first(),g.is(":not(:disabled")&&(g.prop("checked",!g.prop("checked")),e(g));else if(40===i)f?d(j.find("ul li, ol li").first()):0===j.next().length?d(j.parent().closest("li").next()):d(j.next());else if(38===i)j.prev().hasClass(m)?d(j.prev().find("ul li, ol li").last()):0===j.prev().length?d(j.parent().closest("li")):d(j.prev());else if(37===i)f?c(j):d(j.parent().closest("li"));else if(39===i)j.hasClass(n)?c(j):f&&d(j.find("ul li, ol li").first());else if(36===i)d(j.closest(".treevue").find("li").first());else if(35===i)d(j.closest(".treevue").find("li").last());else{if(106!==i)return;c(j.closest(".treevue").find("li."+n))}return b.preventDefault(),b.stopPropagation(),!1}}).on("click",".treevue_fallback_branch button",function(){c(a(this).closest("li"))})})}(jQuery),function(a){"use strict";function b(d){var e,f,g,h=a("<li></li>");return d.selected||d.disabled||d.subselector?(f=d.id||"treevue-node-"+(c+=1),e=a('<input type="checkbox" />').appendTo(h).prop("checked",d.selected).prop("disabled",d.disabled).attr("value",d.value).attr("id",f),d.subselector&&e.attr("data-type","subselector"),a("<label />").text(d.label).attr("for",f).appendTo(h)):h.text(d.label),d.children&&(g=a("<ul/>").appendTo(h).append(a.map(d.children,b)),d.collapsed&&g.attr("aria-hidden",!0)),h}var c=0;a.treevue=function(c){return a("<ul />").append(a.map(c,b)).treevue()}}(jQuery),function(a){"use strict";function b(e){var f,g,h={};return e=a(e),g=e.find(":checkbox:first()"),f=e.find("ul:first() > li, ol:first() > li"),f.length>0&&(h.children=a.map(f,b),h.collapsed=e.hasClass(c)),g.closest("li").is(e)?(h.disabled=e.hasClass(d),h.value=g.attr("value"),h.selected=g.prop("checked"),h.subselector="subselector"===g.attr("data-type"),h.label=a.trim(e.find("label:first()").text())):h.label=a.trim(e.clone().find("ul, ol, [aria-hidden]").remove().end().text()),h}var c="treevue-collapsed",d="treevue-disabled";a.fn.treevueJson=function(){if(!this.first().is(".treevue"))throw new Error("This node is not a treevue");return a.map(this.first().children(),b)}}(jQuery);