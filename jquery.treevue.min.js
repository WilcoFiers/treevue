/*! jQuery Treevue 2013-06-17 */
!function(a){"use strict";function b(b,c){var d,e=a(c),f=e.attr("value");return f||(d=a("label[for="+e.context.id+"]"),0===d.length&&(d=e.closest("label")),d&&(f=a.trim(d.text()))),f}function c(a){a.find("li").attr(k,"treeitem"),a.find("ul, ol").attr(k,"group").before(f).closest("li").attr(g,!0).addClass(m),a.find("ul[aria-hidden=true], ol[aria-hidden=true]").closest("li").find("."+m).andSelf().attr(g,"false").removeClass(m).addClass(n).find("ul, ol").attr(i,!0).hide(),a.attr(k,"tree").find(":disabled").closest("li").addClass(p).attr(j,!0)}function d(b){b.find(":checkbox").each(function(){var b,c=a(this).attr("tabindex",-1);c.prop("checked")?c.addClass(o).closest("li").attr(h,!0):c.removeClass(o).closest("li").attr(h,!1),c.is('[data-type="subselector"]')&&(b=c.closest("li").find(":checkbox:not(:first())"),0!==b.length&&c.prop("checked",b.length===b.filter(":checked").length))}).closest(".treevue").attr("aria-multiselectable",!0)}var e,f,g="aria-expanded",h="aria-selected",i="aria-hidden",j="aria-disabled",k="role",l="treevue-focus",m="treevue-expanded",n="treevue-collapsed",o="treevue-selected",p="treevue-disabled",q="Collapse node",r="Expand node",s="Tree view",t={position:"absolute",width:"0",overflow:"hidden"},u={};u[k]="document",u[i]=!0,e=a('<span class="treevue_fallback">'+s+", </span>").css(t).attr(u),f=a('<span class="treevue_fallback_branch"><button tabindex="-1">'+q+"</button></span>").css(t).attr(u),a.fn.treevue=function(){return this.addClass("treevue").find("li").attr("tabindex",-1),c(this),d(this),this.find("> :first-child").attr("tabindex",0).addClass(l).prepend(e),this},a(function(){function c(b){var c={target:b.context},d=a();b.each(function(){d=d.add(a("ul, ol",this).first())}),b.hasClass(m)?(d.hide(200).attr(i,!0),b.addClass(n).removeClass(m).attr(g,!1).find(".treevue_fallback_branch button").first().text(r),b.trigger(a.Event("treevue:collapse",c))):(d.show(200).attr(i,!1),b.addClass(m).removeClass(n).attr(g,!0).find(".treevue_fallback_branch button").first().text(q),b.trigger(a.Event("treevue:expand",c)))}function d(a){var b=a.closest(".treevue");1===b.length&&(b.find("."+l).removeClass(l).attr("tabindex",-1),a.focus().attr("tabindex",0).addClass(l),b.find(".treevue_fallback").detach().prependTo(a))}function e(c){var d=c.closest("[aria-selected]"),e=c.prop("checked"),f=c.closest(".treevue"),g=c.closest("li");d.attr(h,e),"subselector"===c.attr("data-type")&&g.find("ul :checkbox, ol :checkbox").not(":disabled").prop("checked",e),g.parentsUntil(f,"li").each(function(){var b,c=a(this),d=a(":checkbox",this).first();d.closest("li").is(c)&&"subselector"===d.attr("data-type")&&(b=c.find("ul :checkbox, ol :checkbox").not(":disabled"),b.length===b.filter(":checked").length?d.prop("checked",!0):e===!1&&d.prop("checked",!1))}),f.trigger(a.Event("treevue:change",{target:f.context,values:f.find(":checked").map(b).get()}))}a("body").on("click",".treevue li."+m+", .treevue li."+n,function(b){if(b.target===this){var e=a(this);b.preventDefault(),c(e),d(e)}}).on("change",".treevue :checkbox",function(){var b=a(this);e(b),d(b.closest("li"))}).on("keydown",".treevue li",function(b){var f,g,i=b.keyCode,j=a(this);if(b.target===this){if(f=j.hasClass(m),13===i&&void 0!==j.attr(h))g=j.find(":checkbox").first(),g.is(":not(:disabled")&&(g.prop("checked",!g.prop("checked")),e(g));else if(40===i)f?d(j.find("ul li, ol li").first()):0===j.next().length?d(j.parent().closest("li").next()):d(j.next());else if(38===i)j.prev().hasClass(m)?d(j.prev().find("ul li, ol li").last()):0===j.prev().length?d(j.parent().closest("li")):d(j.prev());else if(37===i)f?c(j):d(j.parent().closest("li"));else if(39===i)j.hasClass(n)?c(j):f&&d(j.find("ul li, ol li").first());else if(36===i)d(j.closest(".treevue").find("li").first());else if(35===i)d(j.closest(".treevue").find("li").last());else{if(106!==i)return;c(j.closest(".treevue").find("li."+n))}return b.preventDefault(),b.stopPropagation(),!1}}).on("click",".treevue_fallback_branch button",function(){c(a(this).closest("li"))})})}(jQuery),function(a){"use strict";function b(e){var f,g,h,i=a("<li></li>");return e.type&&i.attr("data-treevue-type",e.type),e.selected||e.disabled||e.subselector?(g=c+(e.id||"treevue-node-"+(d+=1)),f=a('<input type="checkbox" />').appendTo(i).prop("checked",e.selected).prop("disabled",e.disabled).attr("value",e.value).attr("id",g),e.subselector&&f.attr("data-type","subselector"),a("<label />").text(e.label).attr("for",g).appendTo(i)):i.text(e.label),e.children&&(h=a("<ul/>").appendTo(i).append(a.map(e.children,b)),e.collapsed&&h.attr("aria-hidden",!0)),i}var c,d=0;a.treevue=function(d,e){return c=e?e+"-":"",a("<ul />").append(a.map(d,b)).treevue()}}(jQuery),function(a){"use strict";function b(e){var f,g,h,i={};return e=a(e),g=e.find(":checkbox:first()"),f=e.find("ul:first() > li, ol:first() > li"),h=e.attr("data-treevue-type"),h&&(i.type=h),f.length>0&&(i.children=a.map(f,b),e.hasClass(c)&&(i.collapsed=!0)),g.closest("li").is(e)?(/treevue-node-/.test(g.attr("id"))===!1&&(i.id=g.attr("id")),i.selected=g.prop("checked"),a.each({disabled:e.hasClass(d),value:g.attr("value"),subselector:"subselector"===g.attr("data-type"),label:a.trim(e.find("label:first()").text())},function(a,b){b&&(i[a]=b)})):i.label=a.trim(e.clone().find("ul, ol, [aria-hidden]").remove().end().text()),i}var c="treevue-collapsed",d="treevue-disabled";a.fn.treevueJson=function(){if(!this.first().is(".treevue"))throw new Error("This node is not a treevue");return a.map(this.first().children(),b)}}(jQuery);